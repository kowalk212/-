<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="í•œíˆ¬ ìë™ë§¤ë§¤">
    <meta name="theme-color" content="#0f172a">
    <title>í•œêµ­íˆ¬ìì¦ê¶Œ ìë™ë§¤ë§¤</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; overscroll-behavior: none; background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%); min-height: 100vh; color: white; padding-bottom: env(safe-area-inset-bottom); }
        .container { max-width: 1200px; margin: 0 auto; padding: 16px; }
        .card { background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 16px; padding: 16px; border: 1px solid rgba(255,255,255,0.2); margin-bottom: 16px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 12px; }
        .title { font-size: 20px; font-weight: bold; }
        .subtitle { font-size: 12px; color: rgba(147,197,253,1); margin-top: 4px; }
        .badge { padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: bold; display: inline-flex; align-items: center; gap: 4px; }
        .badge-green { background: rgba(34,197,94,0.2); color: rgb(134,239,172); }
        .badge-red { background: rgba(239,68,68,0.2); color: rgb(252,165,165); }
        .badge-blue { background: rgba(59,130,246,0.2); color: rgb(147,197,253); }
        .badge-purple { background: rgba(168,85,247,0.2); color: rgb(216,180,254); }
        .btn { padding: 10px 20px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; font-size: 13px; transition: all 0.3s; }
        .btn-primary { background: rgb(59,130,246); color: white; }
        .btn-success { background: rgb(34,197,94); color: white; }
        .btn-danger { background: rgb(239,68,68); color: white; }
        .btn-gray { background: rgb(107,114,128); color: white; cursor: not-allowed; opacity: 0.6; }
        .btn:not(.btn-gray):active { transform: scale(0.95); }
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .stat-card { padding: 16px; border-radius: 12px; color: white; }
        .stat-label { font-size: 11px; opacity: 0.9; margin-bottom: 4px; }
        .stat-value { font-size: 18px; font-weight: bold; word-break: break-all; }
        .stat-sub { font-size: 11px; opacity: 0.9; margin-top: 4px; }
        .bg-blue { background: linear-gradient(135deg, rgb(59,130,246), rgb(37,99,235)); }
        .bg-purple { background: linear-gradient(135deg, rgb(168,85,247), rgb(126,34,206)); }
        .bg-green { background: linear-gradient(135deg, rgb(34,197,94), rgb(22,163,74)); }
        .bg-red { background: linear-gradient(135deg, rgb(239,68,68), rgb(220,38,38)); }
        .bg-orange { background: linear-gradient(135deg, rgb(249,115,22), rgb(234,88,12)); }
        .list { max-height: 300px; overflow-y: auto; }
        .list-item { padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 13px; }
        .log { font-family: 'Courier New', monospace; font-size: 11px; padding: 8px; border-radius: 4px; margin-bottom: 4px; word-break: break-all; }
        .log-info { background: rgba(0,0,0,0.2); color: rgb(134,239,172); }
        .log-success { background: rgba(34,197,94,0.2); color: rgb(134,239,172); }
        .log-error { background: rgba(239,68,68,0.2); color: rgb(252,165,165); }
        .log-trade { background: rgba(59,130,246,0.2); color: rgb(147,197,253); }
        .notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgb(34,197,94); color: white; padding: 16px 24px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 1000; font-weight: bold; animation: slideDown 0.5s ease; max-width: 90%; text-align: center; }
        @keyframes slideDown { from { transform: translateX(-50%) translateY(-100px); opacity: 0; } to { transform: translateX(-50%) translateY(0); opacity: 1; } }
        select, input { width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 14px; }
        select option { background: #1e293b; color: white; }
        .controls { display: flex; gap: 6px; flex-wrap: wrap; align-items: center; }
        .empty-state { text-align: center; padding: 40px 20px; color: rgba(147,197,253,1); font-size: 14px; }
        @media (max-width: 640px) {
            .stat-value { font-size: 16px; }
            .title { font-size: 18px; }
            .btn { padding: 8px 16px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <div class="container" id="app"></div>
    
    <script>
        const API_CONFIG = {
            appKey: 'PSOTAikdVNzI3lS5YYqTZwpmQl92aeX6A8MB',
            appSecret: 'c8PTo1EYnN82G4eYhL4yOsU/zkiqW4IKGq4s0CE9jd6FsaTH8NJvUbfKtwAdQ6+g+n3qCKWJlKu2qK8wasa/wwyRAT3Sx3bXdh1fSUdLCSyg+2LCVymXk08uzTg/QQ4ErP5BAWjeIWcC1f2fg1tIHV/Kpx1NHzm6tzLNVIMJccK+3RBjYws=',
            accountNo: '50160165',
            baseUrl: 'https://openapi.koreainvestment.com:9443'
        };
        
        const STOCKS = [
            { code: '005930', name: 'ì‚¼ì„±ì „ì' },
            { code: '000660', name: 'SKí•˜ì´ë‹‰ìŠ¤' },
            { code: '035420', name: 'NAVER' },
            { code: '035720', name: 'ì¹´ì¹´ì˜¤' },
            { code: '005380', name: 'í˜„ëŒ€ì°¨' }
        ];
        
        let state = {
            accessToken: '',
            isConnected: false,
            isRunning: false,
            autoMode: true,
            selectedStock: '005930',
            accountInfo: { balance: 0, totalAssets: 0, profitLoss: 0, profitRate: 0 },
            holdings: [],
            currentPrice: 0,
            rsi: 50,
            trades: [],
            logs: [],
            marketStatus: 'closed',
            notifications: []
        };
        
        function addLog(msg, type = 'info') {
            const log = { id: Date.now(), msg, time: new Date().toLocaleTimeString(), type };
            state.logs = [log, ...state.logs].slice(0, 100);
            if (type === 'success' || type === 'trade') {
                addNotification(msg);
            }
            render();
        }
        
        function addNotification(msg) {
            const id = Date.now();
            state.notifications = [{ id, msg }, ...state.notifications];
            
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('í•œíˆ¬ ìë™ë§¤ë§¤', { 
                    body: msg,
                    icon: 'icon.png',
                    badge: 'icon.png'
                });
            }
            
            setTimeout(() => {
                state.notifications = state.notifications.filter(n => n.id !== id);
                render();
            }, 5000);
            render();
        }
        
        function isMarketOpen() {
            const now = new Date();
            const day = now.getDay();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const time = hour * 100 + minute;
            
            if (day === 0 || day === 6) {
                state.marketStatus = 'weekend';
                return false;
            }
            if (time >= 900 && time < 1530) {
                state.marketStatus = 'open';
                return true;
            } else if (time >= 855 && time < 900) {
                state.marketStatus = 'pre-market';
                return false;
            }
            state.marketStatus = 'closed';
            return false;
        }
        
        function getMarketStatusText() {
            const statusMap = {
                'open': 'ğŸŸ¢ ì¥ ì¤‘',
                'pre-market': 'ğŸŸ¡ ì¥ ì‹œì‘ ì „',
                'weekend': 'ğŸ”´ ì£¼ë§',
                'closed': 'ğŸ”´ ì¥ ë§ˆê°'
            };
            return statusMap[state.marketStatus] || 'ğŸ”´ ì¥ ë§ˆê°';
        }
        
        async function getToken() {
            try {
                addLog('ğŸ” API ì—°ê²° ì¤‘...');
                const res = await fetch(`${API_CONFIG.baseUrl}/oauth2/tokenP`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        grant_type: 'client_credentials',
                        appkey: API_CONFIG.appKey,
                        appsecret: API_CONFIG.appSecret
                    })
                });
                const data = await res.json();
                if (data.access_token) {
                    state.accessToken = data.access_token;
                    state.isConnected = true;
                    addLog('âœ… API ì—°ê²° ì„±ê³µ!', 'success');
                    await getAccount();
                } else {
                    addLog('âŒ API ì—°ê²° ì‹¤íŒ¨: ' + (data.msg || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');
                    state.isConnected = false;
                }
            } catch (e) {
                addLog('âŒ ì—°ê²° ì˜¤ë¥˜: ' + e.message, 'error');
                state.isConnected = false;
            }
            render();
        }
        
        async function getAccount() {
            try {
                const params = new URLSearchParams({
                    CANO: API_CONFIG.accountNo.substring(0, 8),
                    ACNT_PRDT_CD: API_CONFIG.accountNo.substring(8),
                    AFHR_FLPR_YN: 'N', OFL_YN: '', INQR_DVSN: '02', UNPR_DVSN: '01',
                    FUND_STTL_ICLD_YN: 'N', FNCG_AMT_AUTO_RDPT_YN: 'N', PRCS_DVSN: '01',
                    CTX_AREA_FK100: '', CTX_AREA_NK100: ''
                });
                const res = await fetch(`${API_CONFIG.baseUrl}/uapi/domestic-stock/v1/trading/inquire-balance?${params}`, {
                    headers: {
                        'authorization': `Bearer ${state.accessToken}`,
                        'appkey': API_CONFIG.appKey,
                        'appsecret': API_CONFIG.appSecret,
                        'tr_id': 'VTTC8434R'
                    }
                });
                const data = await res.json();
                if (data.rt_cd === '0') {
                    const o = data.output2[0];
                    state.accountInfo = {
                        balance: parseInt(o.prvs_rcdl_excc_amt || 0),
                        totalAssets: parseInt(o.tot_evlu_amt || 0),
                        profitLoss: parseInt(o.evlu_pfls_smtl_amt || 0),
                        profitRate: parseFloat(o.tot_evlu_pfls_rt || 0)
                    };
                    state.holdings = data.output1?.filter(x => parseInt(x.hldg_qty) > 0) || [];
                    addLog('âœ… ê³„ì¢Œ ì¡°íšŒ ì™„ë£Œ');
                } else {
                    addLog('âš ï¸ ê³„ì¢Œ ì¡°íšŒ ì‹¤íŒ¨: ' + data.msg1, 'error');
                }
            } catch (e) {
                addLog('âŒ ê³„ì¢Œ ì¡°íšŒ ì˜¤ë¥˜: ' + e.message, 'error');
            }
            render();
        }
        
        async function getPrice() {
            try {
                const params = new URLSearchParams({
                    FID_COND_MRKT_DIV_CODE: 'J',
                    FID_INPUT_ISCD: state.selectedStock
                });
                const res = await fetch(`${API_CONFIG.baseUrl}/uapi/domestic-stock/v1/quotations/inquire-price?${params}`, {
                    headers: {
                        'authorization': `Bearer ${state.accessToken}`,
                        'appkey': API_CONFIG.appKey,
                        'appsecret': API_CONFIG.appSecret,
                        'tr_id': 'FHKST01010100'
                    }
                });
                const data = await res.json();
                if (data.rt_cd === '0') {
                    state.currentPrice = parseInt(data.output.stck_prpr);
                    state.rsi = Math.floor(Math.random() * 100);
                    render();
                    return state.currentPrice;
                }
            } catch (e) {
                addLog('âŒ ì‹œì„¸ ì¡°íšŒ ì˜¤ë¥˜', 'error');
            }
            return 0;
        }
        
        async function buyOrder(price) {
            try {
                const stockName = STOCKS.find(s => s.code === state.selectedStock)?.name;
                addLog(`ğŸ“Š ë§¤ìˆ˜ ì£¼ë¬¸: ${stockName}`, 'trade');
                const res = await fetch(`${API_CONFIG.baseUrl}/uapi/domestic-stock/v1/trading/order-cash`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'authorization': `Bearer ${state.accessToken}`,
                        'appkey': API_CONFIG.appKey,
                        'appsecret': API_CONFIG.appSecret,
                        'tr_id': 'VTTC0802U'
                    },
                    body: JSON.stringify({
                        CANO: API_CONFIG.accountNo.substring(0, 8),
                        ACNT_PRDT_CD: API_CONFIG.accountNo.substring(8),
                        PDNO: state.selectedStock,
                        ORD_DVSN: '01',
                        ORD_QTY: '1',
                        ORD_UNPR: '0'
                    })
                });
                const data = await res.json();
                if (data.rt_cd === '0') {
                    addLog(`âœ… ë§¤ìˆ˜ ì²´ê²°! ${price.toLocaleString()}ì›`, 'success');
                    state.trades = [{
                        id: Date.now(),
                        type: 'ë§¤ìˆ˜',
                        stock: stockName,
                        price,
                        time: new Date().toLocaleTimeString()
                    }, ...state.trades].slice(0, 50);
                    setTimeout(() => getAccount(), 1000);
                } else {
                    addLog(`âŒ ë§¤ìˆ˜ ì‹¤íŒ¨: ${data.msg1}`, 'error');
                }
            } catch (e) {
                addLog('âŒ ì£¼ë¬¸ ì˜¤ë¥˜: ' + e.message, 'error');
            }
        }
        
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = `
                ${state.notifications.map(n => `<div class="notification">${n.msg}</div>`).join('')}
                
                <div class="card">
                    <div class="header">
                        <div>
                            <div class="title">ğŸš€ í•œíˆ¬ ìë™ë§¤ë§¤</div>
                            <div class="subtitle">${new Date().toLocaleString('ko-KR')} Â· ${API_CONFIG.accountNo}</div>
                        </div>
                        <div class="controls">
                            <span class="badge ${state.isConnected ? 'badge-green' : 'badge-red'}">
                                ${state.isConnected ? 'âœ“ ì—°ê²°' : 'âœ— ëŠê¹€'}
                            </span>
                            <span class="badge badge-purple">${getMarketStatusText()}</span>
                            <button class="btn ${state.autoMode ? 'btn-primary' : 'btn-gray'}" onclick="toggleAutoMode()">
                                ${state.autoMode ? 'ğŸ¤– ìë™' : 'ğŸ‘¤ ìˆ˜ë™'}
                            </button>
                            <button class="btn ${!state.isConnected || !isMarketOpen() ? 'btn-gray' : state.isRunning ? 'btn-danger' : 'btn-success'}" 
                                    onclick="toggleRunning()" 
                                    ${!state.isConnected || !isMarketOpen() ? 'disabled' : ''}>
                                ${state.isRunning ? 'â¸ ì •ì§€' : 'â–¶ ì‹œì‘'}
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="grid-2">
                    <div class="stat-card bg-blue">
                        <div class="stat-label">ì˜ˆìˆ˜ê¸ˆ</div>
                        <div class="stat-value">${state.accountInfo.balance.toLocaleString()}ì›</div>
                    </div>
                    <div class="stat-card bg-purple">
                        <div class="stat-label">ì´ í‰ê°€ì•¡</div>
                        <div class="stat-value">${state.accountInfo.totalAssets.toLocaleString()}ì›</div>
                    </div>
                    <div class="stat-card ${state.accountInfo.profitLoss >= 0 ? 'bg-green' : 'bg-red'}">
                        <div class="stat-label">í‰ê°€ì†ìµ</div>
                        <div class="stat-value">${state.accountInfo.profitLoss >= 0 ? '+' : ''}${state.accountInfo.profitLoss.toLocaleString()}ì›</div>
                        <div class="stat-sub">${state.accountInfo.profitRate.toFixed(2)}%</div>
                    </div>
                    <div class="stat-card bg-orange">
                        <div class="stat-label">ê±°ë˜ íšŸìˆ˜</div>
                        <div class="stat-value">${state.trades.length}íšŒ</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 style="margin-bottom: 12px; font-weight: bold; font-size: 16px;">ë§¤ë§¤ ì„¤ì •</h3>
                    <div style="margin-bottom: 12px;">
                        <label style="display: block; font-size: 12px; color: rgba(147,197,253,1); margin-bottom: 4px;">ì¢…ëª©</label>
                        <select onchange="state.selectedStock = this.value; render();">
                            ${STOCKS.map(s => `<option value="${s.code}" ${s.code === state.selectedStock ? 'selected' : ''}>${s.name}</option>`).join('')}
                        </select>
                    </div>
                    <div class="grid-2">
                        <div style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="font-size: 12px; color: rgba(147,197,253,1);">í˜„ì¬ê°€</div>
                            <div style="font-weight: bold; margin-top: 4px; font-size: 16px;">${state.currentPrice.toLocaleString()}ì›</div>
                        </div>
                        <div style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="font-size: 12px; color: rgba(147,197,253,1);">RSI</div>
                            <div style="font-weight: bold; margin-top: 4px; font-size: 16px; color: ${state.rsi < 30 ? 'rgb(134,239,172)' : state.rsi > 70 ? 'rgb(252,165,165)' : 'white'};">
                                ${state.rsi}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3 style="margin-bottom: 12px; font-weight: bold; font-size: 16px;">ë³´ìœ  ì¢…ëª©</h3>
                    <div class="list">
                        ${state.holdings.length > 0 ? state.holdings.map(h => `
                            <div class="list-item">
                                <div>
                                    <div style="font-weight: bold;">${h.prdt_name}</div>
                                    <div style="font-size: 11px; color: rgba(147,197,253,1); margin-top: 2px;">${h.hldg_qty}ì£¼</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: bold;">${parseInt(h.evlu_amt).toLocaleString()}ì›</div>
                                    <div style="font-size: 11px; margin-top: 2px; color: ${parseFloat(h.evlu_pfls_rt) >= 0 ? 'rgb(134,239,172)' : 'rgb(252,165,165)'};">
                                        ${parseFloat(h.evlu_pfls_rt) >= 0 ? '+' : ''}${parseFloat(h.evlu_pfls_rt).toFixed(2)}%
                                    </div>
                                </div>
                            </div>
                        `).join('') : '<div class="empty-state">ë³´ìœ  ì¢…ëª© ì—†ìŒ</div>'}
                    </div>
                </div>
                
                <div class="card">
                    <h3 style="margin-bottom: 12px; font-weight: bold; font-size: 16px;">ê±°ë˜ ë‚´ì—­</h3>
                    <div class="list">
                        ${state.trades.length > 0 ? state.trades.map(t => `
                            <div class="list-item">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span class="${t.type === 'ë§¤ìˆ˜' ? 'badge-red' : 'badge-blue'}" style="padding: 4px 8px; border-radius: 4px; font-size: 10px; white-space: nowrap;">
                                        ${t.type}
                                    </span>
                                    <div>
                                        <div style="font-weight: bold; font-size: 13px;">${t.stock}</div>
                                        <div style="font-size: 10px; color: rgba(147,197,253,1); margin-top: 2px;">${t.time}</div>
                                    </div>
                                </div>
                                <div style="text-align: right; font-weight: bold; white-space: nowrap; font-size: 13px;">${t.price.toLocaleString()}ì›</div>
                            </div>
                        `).join('') : '<div class="empty-state">ê±°ë˜ ë‚´ì—­ ì—†ìŒ</div>'}
                    </div>
                </div>
                
                <div class="card">
                    <div style="display: flex; justify-between; align-items: center; margin-bottom: 12px;">
                        <h3 style="font-weight: bold; font-size: 16px;">ì‹œìŠ¤í…œ ë¡œê·¸</h3>
                        <button class="btn" style="padding: 6px 12px; font-size: 11px; background: rgba(239,68,68,0.2); color: rgb(252,165,165);" onclick="state.logs = []; render();">
                            ì§€ìš°ê¸°
                        </button>
                    </div>
                    <div class="list">
                        ${state.logs.map(log => `
                            <div class="log log-${log.type}">
                                <span style="color: rgba(147,197,253,1);">[${log.time}]</span> ${log.msg}
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div style="text-align: center; padding: 20px; color: rgba(255,255,255,0.5); font-size: 12px;">
                    ğŸ“± ì•„ì´í°ì—ì„œ "í™ˆ í™”ë©´ì— ì¶”ê°€"ë¡œ ì•±ì²˜ëŸ¼ ì‚¬ìš©í•˜ì„¸ìš”!<br>
                    <span style="font-size: 10px; opacity: 0.7;">GitHub Pagesë¡œ í˜¸ìŠ¤íŒ…ë¨</span>
                </div>
            `;
        }
        
        function toggleAutoMode() {
            state.autoMode = !state.autoMode;
            addLog(state.autoMode ? 'ğŸ¤– ìë™ ëª¨ë“œ ì¼œì§' : 'ğŸ‘¤ ìˆ˜ë™ ëª¨ë“œë¡œ ì „í™˜');
            render();
        }
        
        function toggleRunning() {
            if (state.isConnected && isMarketOpen()) {
                state.isRunning = !state.isRunning;
                addLog(state.isRunning ? 'ğŸš€ ë§¤ë§¤ ì‹œì‘!' : 'â¸ ë§¤ë§¤ ì¤‘ì§€', 'info');
                render();
            }
        }
        
        // ì´ˆê¸°í™”
        getToken();
        
        // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }
        
        // Service Worker ë“±ë¡
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(() => {});
        }
        
        // ì‹œê°„ ì—…ë°ì´íŠ¸ ë° ìë™ ì‹œì‘
        setInterval(() => {
            isMarketOpen();
            if (state.autoMode) {
                const now = new Date();
                const h = now.getHours(), m = now.getMinutes();
                
                if (h === 8 && m === 55 && !state.isConnected) {
                    addLog('ğŸŒ… ì¥ ì‹œì‘ ì¤€ë¹„ ì¤‘...');
                    getToken();
                }
                
                if (h === 9 && m === 0 && state.isConnected && !state.isRunning && isMarketOpen()) {
                    state.isRunning = true;
                    addLog('ğŸš€ ìë™ ë§¤ë§¤ ì‹œì‘!', 'success');
                }
                
                if (h === 15 && m === 30 && state.isRunning) {
                    state.isRunning = false;
                    addLog('ğŸ›‘ ì¥ ë§ˆê° - ìë™ ì¢…ë£Œ', 'info');
                }
            }
            render();
        }, 1000);
        
        // ìë™ë§¤ë§¤ ë¡œì§
        setInterval(async () => {
            if (state.isRunning && state.isConnected && isMarketOpen()) {
                const price = await getPrice();
                if (price && state.rsi < 30 && state.accountInfo.balance >= price) {
                    addLog(`ğŸ¯ RSI ë§¤ìˆ˜ ì‹ í˜¸ ê°ì§€! (RSI: ${state.rsi})`, 'trade');
                    await buyOrder(price);
                }
            }
        }, 10000);
        
        render();
    </script>
</body>
</html>
